

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>View Squad</title>
  <style>
    :root { --accent-color: #a00000; --text-color: #fff; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f8;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 { color: var(--accent-color); }
    #formation {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin: 20px auto;
      max-width: 700px;
    }
    .row {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    .position {
      background: linear-gradient(to bottom, #fff, var(--accent-color));
      border-radius: 8px;
      min-width: 100px;
      min-height: 60px;
      padding: 5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      color: var(--text-color);
    }
    .card {
      cursor: grab;
      background: #fff3;
      padding: 6px;
      border-radius: 6px;
      color: #000;
    }
    .name { font-weight: bold; font-size: 15px; }
    .meta { font-size: 13px; opacity: 0.9; }
    #subs {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      background: #222;
      padding: 15px;
      border-radius: 12px;
      color: #fff;
      margin-top: 30px;
    }
    button {
      background: var(--accent-color);
      color: #fff;
      border: none;
      padding: 10px 16px;
      font-size: 15px;
      border-radius: 6px;
      margin: 10px;
      cursor: pointer;
    }
    button:hover { background: #800000; }
  </style>
</head>
<body>
  <h1 id="club-name">Loading...</h1>
  <button id="toggleEdit">‚úèÔ∏è Change Lineup</button>
  <button onclick="saveLineup()">üíæ Save Lineup</button>

  <div id="formation">
    <div class="row forwards">
      <div class="position" id="LW" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="ST" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="RW" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>
    <div class="row mids">
      <div class="position" id="LCM" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="CM" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="RCM" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>
    <div class="row defense">
      <div class="position" id="LB" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="LCB" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="RCB" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="position" id="RB" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>
    <div class="row gk">
      <div class="position" id="GK" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>
  </div>

  <h2>Substitutes</h2>
  <div id="subs"></div>

  <!-- ‚ö†Ô∏è Load squads BEFORE this script -->
  <script src="squads.js"></script>
  <script>
    let editing = false;

    const teamName = localStorage.getItem("selectedTeam") || "Arsenal";
    const teamData = squads[teamName];
    const lineup = teamData.lineup;
    const subsList = [...teamData.subs];

    document.getElementById("club-name").textContent = `${teamName} Lineup`;

    function allowDrop(ev) {
      if (editing) ev.preventDefault();
    }
    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.id);
    }
    function drop(ev) {
      ev.preventDefault();
      const draggedId = ev.dataTransfer.getData("text");
      const dragged = document.getElementById(draggedId);
      const target = ev.target.closest(".position");
      if (!dragged || !target || !editing) return;

      const [nameLine, metaLine] = dragged.innerText.split("\n");
      if (!nameLine || !metaLine) return;

      const playerName = nameLine.trim();
      const [_, ratingStr] = metaLine.split("‚Ä¢").map(x => x.trim());
      const rating = parseInt(ratingStr);

      const playerObj = {
        name: playerName,
        position: target.id,
        rating
      };

      if (draggedId.startsWith("player-")) {
        const from = draggedId.replace("player-", "");
        delete lineup[from];
      } else if (draggedId.startsWith("sub-")) {
        const index = parseInt(draggedId.split("-")[1]);
        subsList.splice(index, 1);
      }

      if (lineup[target.id]) {
        subsList.push(lineup[target.id]);
      }

      lineup[target.id] = playerObj;
      renderAll();
    }

    function renderPlayer(player, position) {
      const slot = document.getElementById(position);
      slot.innerHTML = "";
      if (!player || !player.name) return;
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <div class="name">${player.name}</div>
        <div class="meta">${player.position} ‚Ä¢ ${player.rating}</div>
      `;
      if (editing) {
        div.id = "player-" + position;
        div.draggable = true;
        div.ondragstart = drag;
      }
      slot.appendChild(div);
    }

    function renderAll() {
      Object.keys(lineup).forEach(pos => renderPlayer(lineup[pos], pos));
      const subs = document.getElementById("subs");
      subs.innerHTML = "";
      subsList.forEach((p, i) => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <div class="name">${p.name}</div>
          <div class="meta">${p.position} ‚Ä¢ ${p.rating}</div>
        `;
        if (editing) {
          div.id = "sub-" + i;
          div.draggable = true;
          div.ondragstart = drag;
        }
        subs.appendChild(div);
      });
    }

    function saveLineup() {
      localStorage.setItem("customFormation", JSON.stringify(lineup));
      alert("‚úÖ Lineup saved!");
    }

    document.getElementById("toggleEdit").onclick = () => {
      editing = !editing;
      document.getElementById("toggleEdit").textContent = editing
        ? "‚úÖ Done Editing"
        : "‚úèÔ∏è Change Lineup";
      renderAll();
    };

    renderAll();
  </script>
</body>
</html>
