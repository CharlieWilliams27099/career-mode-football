<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>View Squad</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: var(--bg, #f5f5f5);
      color: var(--text-color, #000);
      padding: 20px;
    }
    h1, h2 {
      margin-top: 0;
    }
    .player-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
      min-height: 50px;
      padding: 10px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    .card {
      background-color: var(--accent-color, #007BFF);
      color: var(--text-color, #fff);
      padding: 10px;
      border-radius: 6px;
      width: 160px;
      cursor: grab;
      user-select: none;
    }
    .card .name {
      font-weight: bold;
    }
    button {
      padding: 8px 16px;
      font-size: 16px;
      border: none;
      background: #007BFF;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    a {
      display: inline-block;
      margin-top: 20px;
      text-decoration: none;
      color: #007BFF;
    }
  </style>
</head>
<body>
  <h1 id="club-name">Loading...</h1>

  <h2>Starting 11</h2>
  <div id="starting" class="player-grid" ondrop="drop(event)" ondragover="allowDrop(event)"></div>

  <h2>Substitutes</h2>
  <div id="subs" class="player-grid" ondrop="drop(event)" ondragover="allowDrop(event)"></div>

  <button onclick="saveLineup()">üíæ Save Lineup</button>
  <br />
  <a href="dashboard.html">‚Üê Back to Dashboard</a>

  <script>
    const squads = {
      "Arsenal": {
        color: "#a00000",
        starters: [
          { name: "Bukayo Saka", position: "RW", rating: 86 },
          { name: "Gabriel Martinelli", position: "LW", rating: 84 },
          { name: "Martin √òdegaard", position: "CAM", rating: 87 }
        ],
        subs: [
          { name: "Emile Smith Rowe", position: "CM", rating: 78 },
          { name: "Reiss Nelson", position: "RW", rating: 76 }
        ]
      },
      "Liverpool": {
        color: "#c8102e",
        starters: [
          { name: "Mohamed Salah", position: "RW", rating: 89 },
          { name: "Virgil van Dijk", position: "CB", rating: 88 },
          { name: "Alisson Becker", position: "GK", rating: 89 }
        ],
        subs: [
          { name: "Cody Gakpo", position: "CF", rating: 83 },
          { name: "Harvey Elliott", position: "CM", rating: 78 }
        ]
      }
    };

    const team = localStorage.getItem("selectedTeam") || "Unknown";
    const data = squads[team];

    function allowDrop(ev) {
      ev.preventDefault();
    }

    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.id);
    }

    function drop(ev) {
      ev.preventDefault();
      const dataId = ev.dataTransfer.getData("text");
      const card = document.getElementById(dataId);
      ev.target.closest(".player-grid").appendChild(card);
    }

    function saveLineup() {
      const starters = Array.from(document.getElementById("starting").children).map(p => p.textContent);
      const subs = Array.from(document.getElementById("subs").children).map(p => p.textContent);
      localStorage.setItem("customLineup", JSON.stringify({ starters, subs }));
      alert("‚úÖ Lineup saved!");
    }

    function setTheme(color) {
      document.documentElement.style.setProperty("--accent-color", color);
      const r = parseInt(color.substr(1, 2), 16);
      const g = parseInt(color.substr(3, 2), 16);
      const b = parseInt(color.substr(5, 2), 16);
      const brightness = (r * 299 + g * 587 + b * 114) / 1000;
      document.documentElement.style.setProperty("--text-color", brightness < 140 ? "#fff" : "#000");
    }

    function show(players, containerId) {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      players.forEach((p, i) => {
        const card = document.createElement("div");
        card.className = "card";
        card.id = `${containerId}-player-${i}`;
        card.draggable = true;
        card.ondragstart = drag;
        card.innerHTML = `<div class="name">${p.name}</div><div class="meta">${p.position} ‚Ä¢ Rating: ${p.rating}</div>`;
        container.appendChild(card);
      });
    }

    if (data) {
      document.getElementById("club-name").textContent = `${team} Lineup`;
      show(data.starters, "starting");
      show(data.subs, "subs");
      setTheme(data.color);
    } else {
      document.getElementById("club-name").textContent = "‚ö†Ô∏è No team selected!";
      setTimeout(() => {
        window.location.href = "league-select.html";
      }, 1500);
    }
  </script>
</body>
</html>
